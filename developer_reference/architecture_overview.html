
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>Architecture Overview &mdash; chaco 5.0.0 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/enthought.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" >
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        LINK_SUFFIX: '',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <script type="text/javascript" src="../_static/js/wrap_on_dot.js"></script>
    <link rel="shortcut icon" href="../_static/img/favicon.ico">
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="chaco 5.0.0 documentation" href="../index.html" > 
  </head>
  <body>
  <div class="container">
    <div class="header">
    </div>
  </div>

    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">chaco 5.0.0 documentation</a></li>
	
  
    <li><a href="#">Architecture Overview</a></li>
  

    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body" role="main">
            
  <div class="section" id="architecture-overview">
<span id="architecture"></span><h1><a class="toc-backref" href="#id1">Architecture Overview</a><a class="headerlink" href="#architecture-overview" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is an overview of not just Chaco, but also Kiva and Enable.</p>
</div>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#architecture-overview" id="id1">Architecture Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#the-relationship-between-chaco-enable-and-kiva" id="id2">The Relationship Between Chaco, Enable, and Kiva</a></p>
<ul>
<li><p><a class="reference internal" href="#kiva" id="id3">Kiva</a></p></li>
<li><p><a class="reference internal" href="#enable" id="id4">Enable</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#chaco" id="id5">Chaco</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="the-relationship-between-chaco-enable-and-kiva">
<span id="chaco-enable-kiva"></span><h2><a class="toc-backref" href="#id2">The Relationship Between Chaco, Enable, and Kiva</a><a class="headerlink" href="#the-relationship-between-chaco-enable-and-kiva" title="Permalink to this headline">¶</a></h2>
<p>Chaco, Enable, and Kiva are three packages in the Enthought Tool Suite.
They have been there for a long time now, since almost the beginning of
Enthought as a company.  Enthought has delivered many applications using
these toolkits. The Kiva and Enable packages are bundled together in the
“Enable” project.</p>
<div class="section" id="kiva">
<h3><a class="toc-backref" href="#id3">Kiva</a><a class="headerlink" href="#kiva" title="Permalink to this headline">¶</a></h3>
<p>Kiva is a 2-D vector drawing library for Python. It serves a purpose similar to
<a class="reference external" href="http://cairographics.org/">Cairo</a>. It allows us to compose vector graphics
for display on the screen or for saving to a variety of vector and image file
formats. To use Kiva, a program instantiates a Kiva <code class="xref py py-class docutils literal notranslate"><span class="pre">GraphicsContext</span></code>
object of an appropriate type, and then makes drawing calls on it like
<code class="xref py py-meth docutils literal notranslate"><span class="pre">gc.draw_image()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">gc.line_to()</span></code>, and <code class="xref py py-meth docutils literal notranslate"><span class="pre">gc.show_text()</span></code>. Kiva
integrates with windowing toolkits like wxWindows and Qt, and it has an OpenGL
backend as well. For wxPython and Qt, Kiva actually performs a high-quality,
fast software rasterization using the Anti-Grain Geometry (AGG) library. For
OpenGL, Kiva has a python extension that makes native OpenGL calls from C++.</p>
<p>Kiva provides a GraphicsContext for drawing onto the screen or saving out to
disk, but it provides no mechanism for user input and control. For this
“control” layer, it would be convenient to have to write only one set of event
callbacks or handlers for all the platforms we support, and all the toolkits on
each platform. The Enable package provides this layer. It insulates all the
rendering and event handling code in Chaco from the minutiae of each GUI
toolkit. Additionally, and to some extent more importantly, Enable defines the
concept of “components” and “containers” that form the foundation of Chaco’s
architecture. In the Enable model, the top-most Window object is responsible for
dispatching events and drawing a single component. Usually, this component is a
container with other containers and components inside it. The container can
perform layout on its internal components, and it controls how events are
subsequently dispatched to its set of components.</p>
</div>
<div class="section" id="enable">
<h3><a class="toc-backref" href="#id4">Enable</a><a class="headerlink" href="#enable" title="Permalink to this headline">¶</a></h3>
<p>Almost every graphical component in Chaco is an instance of an
Enable component or container.  We’re currently trying to push more of the
layout system (implemented as the various different kinds of Chaco plot
containers) down into Enable, but as things currently stand, you have to
use Chaco containers if you want to get layout.  The general trend has been
that we implement some nifty new thing in Chaco, and then realize that it
is a more general tool or overlay that will be useful for other
non-plotting visual applications.  We then move it into Enable, and if
there are plotting-specific aspects of it, we will create an appropriate
subclass in Chaco to encapsulate that behavior.</p>
<p>The sorts of applications that can and should be done at the Enable level
include things like a visual programming canvas or a vector drawing tool.
There is nothing at the Enable level that understands the concept of
mapping between a data space to screen space and vice versa.  Although
there has been some debate about the incorporating rudimentary mapping into
Enable, for the time being, if you want some kind of canvas-like thing to
model more than just pixel space on the screen, implement it using
the mechanisms in Chaco.</p>
<p>The way that Enable hooks up to the underlying GUI toolkit system is via an
<code class="xref py py-class docutils literal notranslate"><span class="pre">enable.Window</span></code> object. Each toolkit has its own implementation of this
object, and they all subclass from <code class="xref py py-class docutils literal notranslate"><span class="pre">enable.AbstractWindow</span></code>. They usually
contain an instance of the GUI toolkit’s specific window object, whether it’s a
<code class="xref py py-class docutils literal notranslate"><span class="pre">wx.Window</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">Qt.QWidget</span></code> or <code class="xref py py-class docutils literal notranslate"><span class="pre">pyglet.window.Window</span></code>. This
instance is created upon initialization of the enable.Window and stored as the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">control</span></code> attribute on the Enable window. From the perspective of the GUI
toolkit, an opaque widget gets created and stuck inside a parent control (or
dialog or frame or window). This instance serves as a proxy between the GUI
toolkit and the world of Enable. When the user clicks inside the widget area,
the <code class="xref py py-attr docutils literal notranslate"><span class="pre">control</span></code> widget calls a method on the enable.Window object, which
then in turn can dispatch the event down the stack of Enable containers and
components. When the system tells the widget to draw itself (e.g., as the result
of a PAINT or EXPOSE event from the OS), the enable.Window is responsible for
creating an appropriate Kiva GraphicsContext (GC), then passing it down through
the object hierarchy so that everyone gets a chance to draw. After all the
components have drawn onto the GC, for the AGG-based bitmap backends, the
enable.Window object is responsible for blitting the rastered off-screen buffer
of the GC into the actual widget’s space on the screen. (For Kiva’s OpenGL
backend, there is no final blit, since calls to the GC render in immediate mode
in the window’s active OpenGL context, but the idea is the same, and the
enable.Window object does perform initialization on the GL GraphicsContext.)</p>
<p>Some of the advantages to using Enable are that it makes mouse and key events
from disparate windowing systems all share the same kind of signature, and be
accessible via the same name. So, if you write bare wxPython and handle a
<code class="xref py py-obj docutils literal notranslate"><span class="pre">key_pressed</span></code> event in wx, this might generate a value of
<code class="xref py py-obj docutils literal notranslate"><span class="pre">wx.WXK_BACK</span></code>. Using Enable, you would just get a “key” back and its value
would be the string “Backspace”, and this would hold true on Qt4 and Pyglet.
Almost all of the event handling and rendering code in Chaco is identical under
all of the backends; there are very few backend-specific changes that need to be
handled at the Chaco level.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">enable.Window</span></code> object has a reference to a single top-level graphical
component (which includes containers, since they are subclasses of
component).  Whenever it gets user input events, it recursively dispatches
all the way down the potentially-nested stack of components.  Whenever a
components wants to signal that it needs to be redrawn, it calls
self.request_redraw(), which ultimately reaches the enable.Window, which
can then make sure it schedules a PAINT event with the OS.  The nice thing
about having the enable.Window object between the GUI toolkits and our
apps, and sitting at the very top of event dispatch, is that we can easily
interject new kinds of events; this is precisely what we did to enable all
of our tools to work with Multitouch.</p>
<p>The basic things to remember about Enable are that:</p>
<ul class="simple">
<li><p>Any place that your GUI toolkit allows you stick a generic widget, you
can stick an Enable component (and this extends to Chaco components, as
well).  Dave Morrill had a neat demonstration of this by embedding
small Chaco plots as cells in a wx Table control.</p></li>
<li><p>If you have some new GUI toolkit, and you want to provide an Enable
backend for it, all you have to do is implement a new Window class for
that backend.  You also need to make sure that Kiva can actually
create a GraphicsContext for that toolkit.  Once the kiva_gl branch is
committed to the trunk, Kiva will be able to render into any GL
context. So if your newfangled unsupported GUI toolkit has a
GLWindow type of thing, then you will be able to use Kiva, Enable, and
Chaco inside it.  This is a pretty major improvement to
interoperability, if only because users now don’t have to download and
install wxPython just to play with Chaco.</p></li>
</ul>
</div>
</div>
<div class="section" id="chaco">
<h2><a class="toc-backref" href="#id5">Chaco</a><a class="headerlink" href="#chaco" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section provides an overview of the relationships between these
classes, and illustrates some sample usages.  For a more detailed list of
the class hierarchy, please see <a class="reference internal" href="../user_manual/modules_and_classes.html#modules-and-classes"><span class="std std-ref">Commonly Used Modules and Classes</span></a>.</p>
</div>
<p>Chaco is meant to be used for writing tools and applications, and code reuse
and good class design are important. We use the math behind the data and
visualizations to give us architectural direction and conceptual modularity.
The Traits framework allows us to use events to couple disjoint components at
another level of modularity.</p>
<p>Also, rather than building super-flexible core objects with myriad
configuration attributes, Chaco’s classes are written with subclassing in mind.
While they are certainly configurable, the classes themselves are written in a
modular way so that subclasses can easily customize particular aspects of a
visual component’s appearance or a tool’s behavior.</p>
<p>At the highest level, Chaco consists of:</p>
<ul class="simple">
<li><p>Visual components that render to screen or an output device
(e.g., <code class="xref py py-class docutils literal notranslate"><span class="pre">LinePlot</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterPlot</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PlotGrid</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">PlotAxis</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Legend</span></code>)</p></li>
<li><p>Data handling classes that wrap input data, interface with
application-specific data sources, and transform coordinates
between data and screen space (e.g., <code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayDataSource</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">GridDataSource</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">LinearMapper</span></code>)</p></li>
<li><p>Tools that handle keyboard or mouse events and modify other
components (e.g., <code class="xref py py-class docutils literal notranslate"><span class="pre">PanTool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ZoomTool</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterInspector</span></code>)</p></li>
</ul>
<p>Every Chaco plot is composed of these elements.  One can think of them
as comprising a “display pipeline”, although the components form more
of a graph.</p>
<p>For example, a simple scatter plot will have:</p>
<ul class="simple">
<li><p>Two <code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayDataSource</span></code> objects, one for the array of X data and one for
the Y data</p></li>
<li><p>Two <code class="xref py py-class docutils literal notranslate"><span class="pre">DataRange1D</span></code> ranges, one for the X axis and one for the Y axis.
If we want the ranges to automatically compute the bounds of the dataset,
then they need a reference to the an <code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayDataSource</span></code>.</p></li>
<li><p>Two independent <code class="xref py py-class docutils literal notranslate"><span class="pre">LinearMapper</span></code> mappers, one for X axis and one for the
Y axis.  The mappers convert from screen space to data space and vice verse,
so they need a reference to the <code class="xref py py-class docutils literal notranslate"><span class="pre">DataRange1D</span></code> objects so they know the
data space extents.</p></li>
<li><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">ScatterPlot</span></code> renderer, that has a reference to two mappers, as
well as an index and a value <code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayDataSource</span></code>.</p></li>
</ul>
<p>This creates <em>only</em> the renderer that draws scatter markers in some region of
screen space.  This does not create an X-axis, a Y-axis, or horizontal and
vertical grids.  These other visuals are embodied as separate, distinct
components: axes are drawn by the <code class="xref py py-class docutils literal notranslate"><span class="pre">PlotAxis</span></code> component, and grids are
drawn by the <code class="xref py py-class docutils literal notranslate"><span class="pre">PlotGrid</span></code> component.  Both of these overlays require a
mapper in order to know where on the screen they should draw.</p>
</div>
</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/img/e-logo.png" alt="Logo">
            </a></p>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Architecture Overview</a><ul>
<li><a class="reference internal" href="#the-relationship-between-chaco-enable-and-kiva">The Relationship Between Chaco, Enable, and Kiva</a><ul>
<li><a class="reference internal" href="#kiva">Kiva</a></li>
<li><a class="reference internal" href="#enable">Enable</a></li>
</ul>
</li>
<li><a class="reference internal" href="#chaco">Chaco</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <div>
    <a href="../_sources/developer_reference/architecture_overview.rst.txt"
       rel="nofollow">Show Source</a>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2019, Enthought, Inc.
      </li>
      <li>
      Last updated on Jun 15, 2021.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 2.3.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>